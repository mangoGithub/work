<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>实例二：天气预报（JSONP）</title>
<link href="css/public.css" rel="stylesheet" />
<link href="css/person.css" rel="stylesheet" />
<script type="text/javascript" src="js/public.js"></script>
<script>

function fn1(data){
	console.log(data.result);
	var oUl = document.getElementById('oUl');
	//var aLi = oUl.getElementsByTagName('li');
	
	for(var i=0; i<data.result.length; i++){
		var li = document.createElement('li');
		li.innerHTML = '<span>'+data.result[i]["citynm"]+'</span><span>'+data.result[i]["days"]+'</span><span>'+data.result[i]["week"]+'</span><span>天气：'+data.result[i]["weather"]+'</span><span>气温：'+data.result[i]["temperature"]+'</span><img src="'+data.result[i]["weat_daytime_icon"]+'" width="28" />';
		
		oUl.appendChild(li);
	}
	//alert(data.result[1]['days']);
	//oUl.innerHTML = li;
	
}
function loadData() {
	var oScript = document.createElement('script');
	oScript.src = 'http://api.k780.com:88/?app=weather.future&weaid=1&appkey=10003&sign=b59bc3ef6191eb9f747dd4e83c99f2a4&format=json&jsoncallback=fn1';
	document.body.appendChild(oScript);
}
window.onload = function(){
	//var oBtn = document.getElementById('button');
	loadData();
}
</script>
<style>
.weather{width:920px; background:#fff; padding:20px; margin:10px 0px;}
.weather li{border-bottom:1px solid #0080c0; height:30px;}
.weather li span{display:inline-block; padding-right:20px; color:#FF3399;}
</style>
</head>
<body class="body">
<div class="Itop">
	<div class="lay">
		<div class="Ilogo" id="logo">我的作品</div>
		<ul class="Inav" id="nav">
			<li><a href="index.html">我的简历</a></li>
			<li><a href="eg.html" class="act">综合实例</a></li>
			<li><a href="status.html">ajax和JSONP</a></li>
			<li><a href="work.html">对象和组件开发</a></li>
			<li><a href="know.html">概念</a></li>
		</ul>
	</div>
</div>

<div class="lay">
	<ul class="weather" id="oUl">
		
	</ul>
	<ul class="exU clear">
		<li>特效分析：
			<p>1,首先要实现跨域问题，所以就用到jsonp</p>
			<p>2,jsonp实现原理：就是创建script标签去加载其他域名下的开源文件（api）</p>
			<p>3,用一个函数来设定全局，从而接收数据</p>
			<p>4,难点就是数据的处理</p>
		</li>
		<li>知识点：
			<p>1,document.createElement('script')创建元素</p>
			<p>2,给元素src加路径，用appendChild()追加到页面</p>
			<p>3,callback=全局函数，来接收数据data</p>
			<p>4,json和数组的分析</p>
		</li>
		
	</ul>
</div>

</body>
</html>
